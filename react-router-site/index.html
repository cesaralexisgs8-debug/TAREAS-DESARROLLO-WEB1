<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InfoPa칤ses React</title>
    <!-- Cargamos estilos (Bootstrap) y librer칤as de React desde internet (CDN) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/react-router-dom@5.3.4/umd/react-router-dom.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { background-color: #f8f9fa; }
        .card-img-top { height: 160px; object-fit: cover; }
        .navbar-brand { font-weight: bold; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Importamos herramientas de React Router y React
        const { HashRouter, Switch, Route, Link, NavLink } = ReactRouterDOM;
        const { useState, useEffect } = React;

        // 1. Navbar: Men칰 de navegaci칩n que no recarga la p치gina
        const Navbar = () => {
            return (
                <nav className="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
                    <div className="container">
                        <Link className="navbar-brand" to="/">游깵 InfoPa칤ses</Link>
                        <button className="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                            <span className="navbar-toggler-icon"></span>
                        </button>
                        <div className="collapse navbar-collapse" id="navbarNav">
                            <ul className="navbar-nav ms-auto">
                                <li className="nav-item">
                                    <NavLink className="nav-link" activeClassName="active" exact to="/">Inicio</NavLink>
                                </li>
                                <li className="nav-item">
                                    <NavLink className="nav-link" activeClassName="active" to="/countries">Lista de Pa칤ses</NavLink>
                                </li>
                            </ul>
                        </div>
                    </div>
                </nav>
            );
        };

        // 2. Home: P치gina de bienvenida simple
        const Home = () => {
            return (
                <div className="container text-center">
                    <div className="card shadow-lg p-5 bg-white rounded">
                        <h1 className="display-4 text-primary mb-3">Bienvenido a InfoPa칤ses</h1>
                        <p className="lead text-muted">La herramienta definitiva para explorar datos geogr치ficos mundiales.</p>
                        <hr className="my-4" />
                        <p>Descubre banderas, capitales y poblaci칩n de m치s de 250 pa칤ses y territorios.</p>
                        <Link to="/countries" className="btn btn-primary btn-lg mt-3">Explorar Ahora 游</Link>
                    </div>
                </div>
            );
        };

        // 3. Countries: P치gina principal con l칩gica de datos
        const Countries = () => {
            // Estados para guardar los datos, carga y b칰squeda
            const [countries, setCountries] = useState([]);
            const [loading, setLoading] = useState(true);
            const [searchTerm, setSearchTerm] = useState('');

            // useEffect: Se ejecuta al inicio para descargar los datos de la API
            useEffect(() => {
                fetch('https://restcountries.com/v3.1/all?fields=name,translations,flags,capital,population')
                    .then(res => res.json())
                    .then(data => {
                        setCountries(data); // Guardamos los pa칤ses
                        setLoading(false);  // Terminamos la carga
                    })
                    .catch(err => {
                        console.error("Error:", err);
                        setLoading(false);
                    });
            }, []);

            // Filtramos la lista seg칰n lo que escriba el usuario
            const filteredCountries = countries.filter(country => {
                const name = country.translations?.spa?.common || country.name?.common || '';
                return name.toLowerCase().includes(searchTerm.toLowerCase());
            });

            // Mostramos un spinner si est치 cargando
            if (loading) {
                return (
                    <div className="container text-center py-5">
                        <div className="spinner-border text-primary" role="status">
                            <span className="visually-hidden">Cargando...</span>
                        </div>
                        <p className="mt-2">Cargando datos...</p>
                    </div>
                );
            }

            // Renderizamos la lista de tarjetas
            return (
                <div className="container">
                    <h2 className="text-center mb-4">Cat치logo de Pa칤ses</h2>
                    
                    {/* Buscador */}
                    <div className="row justify-content-center mb-4">
                        <div className="col-md-8">
                            <input
                                type="text"
                                className="form-control form-control-lg shadow-sm"
                                placeholder="游댌 Escribe el nombre de un pa칤s..."
                                value={searchTerm}
                                onChange={(e) => setSearchTerm(e.target.value)}
                            />
                        </div>
                    </div>

                    {/* Grid de Tarjetas */}
                    <div className="row row-cols-1 row-cols-md-3 g-4">
                        {filteredCountries.map((country, index) => (
                            <div className="col" key={index}>
                                <div className="card h-100 shadow-sm border-0">
                                    <img 
                                        src={country.flags?.png} 
                                        className="card-img-top" 
                                        alt={country.name.common}
                                    />
                                    <div className="card-body">
                                        <h5 className="card-title fw-bold text-primary">
                                            {country.translations?.spa?.common || country.name.common}
                                        </h5>
                                        <p className="card-text mb-1">
                                            <i className="bi bi-geo-alt-fill"></i> <strong>Capital:</strong> {country.capital ? country.capital.join(', ') : 'N/A'}
                                        </p>
                                        <p className="card-text">
                                            <i className="bi bi-people-fill"></i> <strong>Poblaci칩n:</strong> {country.population.toLocaleString()}
                                        </p>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                    
                    {/* Mensaje si no hay resultados */}
                    {filteredCountries.length === 0 && (
                        <div className="alert alert-warning text-center mt-4">
                            No se encontraron resultados para "{searchTerm}".
                        </div>
                    )}
                </div>
            );
        };

        // 4. App: Configuraci칩n de Rutas (Navegaci칩n)
        const App = () => {
            return (
                <HashRouter>
                    <div className="d-flex flex-column min-vh-100">
                        <Navbar />
                        <main className="flex-grow-1 pb-5">
                            <Switch>
                                {/* Define qu칠 componente mostrar seg칰n la URL */}
                                <Route exact path="/" component={Home} />
                                <Route path="/countries" component={Countries} />
                            </Switch>
                        </main>
                        <footer className="bg-dark text-white text-center py-3 mt-auto">
                            <div className="container">
                                <p className="mb-0">&copy; 2025 InfoPa칤ses React. Hecho con 仇벒잺</p>
                            </div>
                        </footer>
                    </div>
                </HashRouter>
            );
        };

        // Montamos la aplicaci칩n en el div con id "root"
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>